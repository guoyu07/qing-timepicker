/* qing-timepicker v0.0.1 | (c) Mycolorway Design | MIT License */
!function(t,e){"object"==typeof module&&module.exports?module.exports=e(require("jquery"),require("moment"),require("qing-module")):t.QingTimepicker=e(t.jQuery,t.QingModule)}(this,function(t,e){var r=require=function t(e,r,i){function o(s,p){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!p&&u)return u(s,!0);if(n)return n(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var h=r[s]={exports:{}};e[s][0].call(h.exports,function(t){var r=e[s][1][t];return o(r?r:t)},h,h.exports,t,e,r,i)}return r[s].exports}for(var n="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(r,i,o){var n,s=function(t,e){function r(){this.constructor=t}for(var i in e)p.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},p={}.hasOwnProperty;n=function(e){function r(e){r.__super__.constructor.apply(this,arguments),this.opts=t.extend({},r.opts,this.opts),this.wrapper=t(this.opts.wrapper),this.active=!1,this._render(),this._bind()}return s(r,e),r.opts={wrapper:null,placeholder:""},r.prototype._render=function(){return this.el=t('<div class="input">'),this.textField=t('<input type="text" class="text-field" readonly>').attr("placeholder",this.opts.placeholder).appendTo(this.el),this.el.appendTo(this.wrapper)},r.prototype._bind=function(){return this.textField.on("click",function(t){return function(e){return t.trigger("click")}}(this))},r.prototype.setValue=function(t){return this.textField.val(t),t},r.prototype.getValue=function(){return this.textField.val()},r.prototype.setActive=function(t){return this.active=t,this.textField.toggleClass("active",t),this.active},r.prototype.selectRange=function(t){var e,r,i;return this.textField.focus(),e=function(){switch(t){case"hour":return[0,2];case"minute":return[3,5];case"second":return[6,8]}}(),i=e[0],r=e[1],this.textField[0].setSelectionRange(i,r)},r.prototype.destroy=function(){return this.el.remove()},r}(e),i.exports=n},{}],2:[function(r,i,o){var n,s,p=function(t,e){return function(){return t.apply(e,arguments)}},u=function(t,e){function r(){this.constructor=t}for(var i in e)c.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=r("./select-view.coffee"),n=function(e){function r(e){this.setTime=p(this.setTime,this),r.__super__.constructor.apply(this,arguments),this.opts=t.extend({},r.opts,this.opts),this.wrapper=t(this.opts.wrapper),this.active=!1,this.selectors=[],this._render(),this._initChildComponents(),this._bind()}return u(r,e),r.opts={wrapper:null,showHour:!0,showMinute:!0,showSecond:!1},r.prototype._render=function(){return this.el=t('<div class="popover"></div>').appendTo(this.wrapper)},r.prototype._initChildComponents=function(){if(this.opts.showHour&&this._initSelectView("hour"),this.opts.showMinute&&this._initSelectView("minute"),this.opts.showSecond)return this._initSelectView("second")},r.prototype._initSelectView=function(t){return this.selectors.push(new s({wrapper:this.el,type:t}))},r.prototype._bind=function(){return this.selectors.forEach(function(t){return function(e){return e.on("hover",function(e,r){return t.trigger("hover",[r])}).on("select",function(e,r,i){return t.time[r](parseInt(i,10)),t.trigger("select",t.time)})}}(this))},r.prototype.setTime=function(t){if(!this.time||!this.time.isSame(t))return this.time=t,this.selectors.forEach(function(t){return function(e){return e.select(t.time[e.type]())}}(this))},r.prototype.setActive=function(t){return this.active=t,this.el.toggleClass("active",t),this.active?(this.trigger("show"),this.selectors.forEach(function(t){return t.scrollToSelected()})):this.trigger("hide"),this.active},r.prototype.setPosition=function(t){return this.el.css({top:t.top,left:t.left||0})},r}(e),i.exports=n},{"./select-view.coffee":3}],3:[function(r,i,o){var n,s=function(t,e){function r(){this.constructor=t}for(var i in e)p.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},p={}.hasOwnProperty;n=function(e){function r(e){r.__super__.constructor.apply(this,arguments),this.opts=t.extend({},r.opts,this.opts),this.wrapper=t(this.opts.wrapper),this.type=this.opts.type,this.items=this._generateItems(),this._render(),this._renderList(),this._bind()}return s(r,e),r.opts={wrapper:null,selectedIndex:0,type:"hour"},r.prototype._render=function(){return this.el=t('<div class="select-view"></div>').appendTo(this.wrapper)},r.prototype._renderList=function(){return this.list=t("<ul></ul>"),this.list.append(this.items.map(function(t,e){return"<li>"+t+"</li>"})),this.list.appendTo(this.el)},r.prototype._bind=function(){return this.list.on("mouseover","li",function(t){return function(e){return t.trigger("hover",[t.type]),e.stopImmediatePropagation()}}(this)).on("click","li",function(e){return function(r){var i;return i=t(r.currentTarget).text(),e.select(i),e.trigger("select",[e.type,i]),e.scrollToSelected(120)}}(this))},r.prototype._generateItems=function(){var t,e;return t="hour"===this.type?24:60,function(){e=[];for(var r=0;0<=t?r<t:r>t;0<=t?r++:r--)e.push(r);return e}.apply(this).map(function(t){return t<10?"0"+t:t.toString()})},r.prototype.select=function(e){if(e=e.toString(),this.selectedValue!==e)return this.selectedValue=e,this.selectedItem=this.list.find("li").get(this.items.indexOf(e)),this.list.find("li.selected").removeClass("selected"),t(this.selectedItem).addClass("selected")},r.prototype.scrollToSelected=function(t){if(this.selectedItem)return this._scrollTo(this.el[0],this.selectedItem.offsetTop,t)},r.prototype._scrollTo=function(t,e,r){var i;return null==r&&(r=0),r<=0?t.scrollTop=e:(i=(e-t.scrollTop)/r*10,window.requestAnimationFrame(function(o){return function(){if(t.scrollTop=t.scrollTop+i,t.scrollTop!==e)return o._scrollTo(t,e,r-10)}}(this)))},r}(e),i.exports=n},{}],"qing-timepicker":[function(r,i,o){var n,s,p,u,c=function(t,e){function r(){this.constructor=t}for(var i in e)h.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},h={}.hasOwnProperty;n=r("./input.coffee"),s=r("./popover.coffee"),p=function(e){function r(e){if(r.__super__.constructor.apply(this,arguments),this.el=t(this.opts.el),!(this.el.length>0))throw new Error("QingTimepicker: option el is required");this.opts=t.extend({},r.opts,this.opts),this.id=++r.count,this._render(),this._initChildComponents(),this._bind(),t.isFunction(this.opts.renderer)&&this.opts.renderer.call(this,this.wrapper,this),this.setTime(moment(this.el.val(),this.opts.format,!0))}return c(r,e),r.opts={el:null,format:"HH:mm:ss",renderer:null},r.count=0,r.prototype._render=function(){return this.wrapper=t('<div class="qing-timepicker"></div>').data("qingTimepicker",this).insertBefore(this.el).append(this.el),this.el.hide().data("qingTimepicker",this)},r.prototype._initChildComponents=function(){var e;return this.input=new n({wrapper:this.wrapper,placeholder:this.opts.placeholder||this.el.attr("placeholder")||""}),e=t.extend({wrapper:this.wrapper},u(this.opts.format)),this.popover=new s(e)},r.prototype._bind=function(){return t(document).on("click.qing-timepicker-"+this.id,function(e){return function(r){if(!t.contains(e.wrapper[0],r.target))return e.popover.setActive(!1)}}(this)),this.input.on("click",function(t){return function(){var e;return t.popover.active?(t.popover.setActive(!1),t.input.setActive(!1)):(t.popover.setTime((null!=(e=t.time)?e.clone():void 0)||moment()),t.popover.setActive(!0),t.input.setActive(!0))}}(this)),this.popover.on("show",function(t){return function(e){return t.popover.setPosition({top:t.input.el.outerHeight()+2})}}(this)).on("hover",function(t){return function(e,r){if(t.time)return t.input.selectRange(r)}}(this)).on("select",function(t){return function(e,r){return t.setTime(r)}}(this))},r.prototype.setTime=function(t){var e,r;if(r=moment.isMoment(t)?t:moment(t,this.opts.format,!0),r.isValid()&&!r.isSame(this.time))return e=r.format(this.opts.format),this.time=r.clone(),this.input.setValue(e),this.el.val(e),this.trigger("change",[e])},r.prototype.getTime=function(){var t;return null!=(t=this.time)?t.format(this.opts.format):void 0},r.prototype.destroy=function(){return this.el.insertAfter(this.wrapper).show().removeData("qingTimepicker"),this.wrapper.remove(),t(document).off(".qing-timepicker-"+this.id)},r}(e),u=function(t){var e;switch(e={},t){case"HH:mm:ss":e.showHour=e.showMinute=e.showSecond=!0;break;case"HH:mm":e.showHour=e.showMinute=!0,e.showSecond=!1;break;case"mm:ss":e.showHour=!1,e.showMinute=e.showSecond=!0}return e},i.exports=p},{"./input.coffee":1,"./popover.coffee":2}]},{},[]);return r("qing-timepicker")});